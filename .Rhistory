# Aggiorna la colonna Ah per la fase di scarica
data$Ah_C5[data$Gruppo == group & data$ID_C5 == -1] <- capacita_erogata_C5
}
#* C7
data$Ah_C7 <- 0
# Ciclo for sui gruppi
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
# Calcola la durata della fase in ore per la fase di scarica
ind_min2_scarica <- min(which(data$ID_C7 == -1 & data$Gruppo == group))
ind_max2_scarica <- max(which(data$ID_C7 == -1 & data$Gruppo == group))
durata_della_scarica <- (data$second[ind_max2_scarica] - data$second[ind_min2_scarica]) / 3600
# Calcola la capacità_erogata
capacita_erogata_C7 <- cumsum(subset_gruppo$HMI_IBatt_C7) * durata_della_scarica
#cat(capacita_erogata_C7,"\n")
# Aggiorna la colonna Ah per la fase di scarica
data$Ah_C7[data$Gruppo == group & data$ID_C7 == -1] <- capacita_erogata_C7
}
#! ---------------- Calcolo e  aggiunta colonna Wattora --------------
# Inizializza una colonna per i Wattora
#* C2
data$Wattora_C2 <- 0
# Ciclo per ogni gruppo
for (group in seq(1, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
# Trova l'indice del primo e dell'ultimo valore negativo in HMI_IBatt_C2
ind_max <- tail(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
ind_min <- head(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
# Calcola la durata della fase in ore
durata_fase <- (subset_gruppo$second[ind_max] - subset_gruppo$second[ind_min]) / 3600
# Calcola i Wattora per il gruppo
wattora_gruppo <- -sum(subset_gruppo$HMI_IBatt_C2[ind_min:ind_max] * subset_gruppo$HMI_VBatt_C2[ind_min:ind_max]) * durata_fase
# Assegna il risultato alla colonna Wattora
data$Wattora_C2[data$Gruppo == group] <- wattora_gruppo
}
#* C4
data$Wattora_C4 <- 0
# Ciclo per ogni gruppo
for (group in seq(1, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
# Trova l'indice del primo e dell'ultimo valore negativo in HMI_IBatt_C2
ind_max <- tail(which(subset_gruppo$HMI_IBatt_C4 < 0), 1)
ind_min <- head(which(subset_gruppo$HMI_IBatt_C4 < 0), 1)
# Calcola la durata della fase in ore
durata_fase <- (subset_gruppo$second[ind_max] - subset_gruppo$second[ind_min]) / 3600
# Calcola i Wattora per il gruppo
wattora_gruppo <- -sum(subset_gruppo$HMI_IBatt_C4[ind_min:ind_max] * subset_gruppo$HMI_VBatt_C4[ind_min:ind_max]) * durata_fase
# Assegna il risultato alla colonna Wattora
data$Wattora_C4[data$Gruppo == group] <- wattora_gruppo
}
#* C5
data$Wattora_C5 <- 0
# Ciclo per ogni gruppo
for (group in seq(1, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
# Trova l'indice del primo e dell'ultimo valore negativo in HMI_IBatt_C2
ind_max <- tail(which(subset_gruppo$HMI_IBatt_C5 < 0), 1)
ind_min <- head(which(subset_gruppo$HMI_IBatt_C5 < 0), 1)
# Calcola la durata della fase in ore
durata_fase <- (subset_gruppo$second[ind_max] - subset_gruppo$second[ind_min]) / 3600
# Calcola i Wattora per il gruppo
wattora_gruppo <- -sum(subset_gruppo$HMI_IBatt_C5[ind_min:ind_max] * subset_gruppo$HMI_VBatt_C5[ind_min:ind_max]) * durata_fase
# Assegna il risultato alla colonna Wattora
data$Wattora_C5[data$Gruppo == group] <- wattora_gruppo
}
#* C7
data$Wattora_C7 <- 0
# Ciclo per ogni gruppo
for (group in seq(1, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
# Trova l'indice del primo e dell'ultimo valore negativo in HMI_IBatt_C2
ind_max <- tail(which(subset_gruppo$HMI_IBatt_C7 < 0), 1)
ind_min <- head(which(subset_gruppo$HMI_IBatt_C7 < 0), 1)
# Calcola la durata della fase in ore
durata_fase <- (subset_gruppo$second[ind_max] - subset_gruppo$second[ind_min]) / 3600
# Calcola i Wattora per il gruppo
wattora_gruppo <- -sum(subset_gruppo$HMI_IBatt_C7[ind_min:ind_max] * subset_gruppo$HMI_VBatt_C7[ind_min:ind_max]) * durata_fase
# Assegna il risultato alla colonna Wattora
data$Wattora_C7[data$Gruppo == group] <- wattora_gruppo
}
View(data)
View(data)
save.image(file = "my_workspace_project_clean.RData")
#* C2
data$Ah_C2 <- 0
# Ciclo for sui gruppi
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
# Calcola la capacità_erogata
capacita_erogata_C2 <- cumsum(subset_gruppo$HMI_IBatt_C2) * subset_gruppo$Durata_scarica/3600
#cat(capacita_erogata_C2,"\n")
# Aggiorna la colonna Ah per la fase di scarica
data$Ah_C2[data$Gruppo == group & data$ID_C2 == -1] <- capacita_erogata_C2
}
#* C4
data$Ah_C4 <- 0
# Ciclo for sui gruppi
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
# Calcola la capacità_erogata
capacita_erogata_C4 <- cumsum(subset_gruppo$HMI_IBatt_C4) * subset_gruppo$Durata_scarica/3600
#cat(capacita_erogata_C4,"\n")
# Aggiorna la colonna Ah per la fase di scarica
data$Ah_C4[data$Gruppo == group & data$ID_C4 == -1] <- capacita_erogata_C4
}
#* C5
data$Ah_C5 <- 0
# Ciclo for sui gruppi
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
# Calcola la capacità_erogata
capacita_erogata_C5 <- cumsum(subset_gruppo$HMI_IBatt_C5) * subset_gruppo$Durata_scarica/3600
#cat(capacita_erogata_C2,"\n")
# Aggiorna la colonna Ah per la fase di scarica
data$Ah_C5[data$Gruppo == group & data$ID_C5 == -1] <- capacita_erogata_C5
}
#* C7
data$Ah_C7 <- 0
# Ciclo for sui gruppi
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
# Calcola la capacità_erogata
capacita_erogata_C7 <- cumsum(subset_gruppo$HMI_IBatt_C7) * subset_gruppo$Durata_scarica/3600
#cat(capacita_erogata_C7,"\n")
# Aggiorna la colonna Ah per la fase di scarica
data$Ah_C7[data$Gruppo == group & data$ID_C7 == -1] <- capacita_erogata_C7
}
warnings()
subset_gruppo <- data[data$Gruppo == 17, ]
# Calcola la durata della fase in secondi per la fase di scarica
data$Durata_scarica <-0
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
ind_min_scarica <- head(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
ind_max_scarica <- tail(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
durata_della_scarica <- (data$second[ind_max_scarica] - data$second[ind_min_scarica])
data$Durata_scarica[data$Gruppo == group & data$ID_C2 == -1]  <- durata_della_scarica
}
subset_gruppo <- data[data$Gruppo == 17, ]
ind_min_scarica <- head(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
ind_max_scarica <- tail(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
durata_della_scarica <- (data$second[ind_max_scarica] - data$second[ind_min_scarica])
durata_della_scarica
head(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
tail(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
ind_min_scarica <- head(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
ind_max_scarica <- tail(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
durata_della_scarica <- (subset_gruppo$second[ind_max_scarica] - subset_gruppo$second[ind_min_scarica])
data$Durata_scarica[data$Gruppo == group & data$ID_C2 == -1]  <- durata_della_scarica
}
ind_min_scarica <- head(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)-1
ind_max_scarica <- tail(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
durata_della_scarica <- (subset_gruppo$second[ind_max_scarica] - subset_gruppo$second[ind_min_scarica])
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
ind_min_scarica <- head(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)-1
ind_max_scarica <- tail(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
durata_della_scarica <- (subset_gruppo$second[ind_max_scarica] - subset_gruppo$second[ind_min_scarica])
data$Durata_scarica[data$Gruppo == group & data$ID_C2 == -1]  <- durata_della_scarica
}
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
ind_min_scarica <- 0
ind_max_scarica <- tail(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
durata_della_scarica <- (subset_gruppo$second[ind_max_scarica] - subset_gruppo$second[ind_min_scarica])
data$Durata_scarica[data$Gruppo == group & data$ID_C2 == -1]  <- durata_della_scarica
}
subset_gruppo <- data[data$Gruppo == 17, ]
ind_min_scarica <- head(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
ind_min_scarica
ind_max_scarica <- tail(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
durata_della_scarica <- (subset_gruppo$second[ind_max_scarica] - subset_gruppo$second[ind_min_scarica])
durata_della_scarica
ind_max_scarica
# Calcola la durata della fase in secondi per la fase di scarica
data$Durata_scarica <-0
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
ind_min_scarica <- head(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
ind_max_scarica <- tail(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
durata_della_scarica <- (subset_gruppo$second[ind_max_scarica] - subset_gruppo$second[ind_min_scarica])
data$Durata_scarica[data$Gruppo == group & data$ID_C2 == -1]  <- durata_della_scarica
}
View(data)
View(data)
#* C2
data$Ah_C2 <- 0
# Ciclo for sui gruppi
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
# Calcola la capacità_erogata
capacita_erogata_C2 <- cumsum(subset_gruppo$HMI_IBatt_C2) * subset_gruppo$Durata_scarica/3600
#cat(capacita_erogata_C2,"\n")
# Aggiorna la colonna Ah per la fase di scarica
data$Ah_C2[data$Gruppo == group & data$ID_C2 == -1] <- capacita_erogata_C2
}
#* C4
data$Ah_C4 <- 0
# Ciclo for sui gruppi
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
# Calcola la capacità_erogata
capacita_erogata_C4 <- cumsum(subset_gruppo$HMI_IBatt_C4) * subset_gruppo$Durata_scarica/3600
#cat(capacita_erogata_C4,"\n")
# Aggiorna la colonna Ah per la fase di scarica
data$Ah_C4[data$Gruppo == group & data$ID_C4 == -1] <- capacita_erogata_C4
}
#* C5
data$Ah_C5 <- 0
# Ciclo for sui gruppi
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
# Calcola la capacità_erogata
capacita_erogata_C5 <- cumsum(subset_gruppo$HMI_IBatt_C5) * subset_gruppo$Durata_scarica/3600
#cat(capacita_erogata_C2,"\n")
# Aggiorna la colonna Ah per la fase di scarica
data$Ah_C5[data$Gruppo == group & data$ID_C5 == -1] <- capacita_erogata_C5
}
#* C7
data$Ah_C7 <- 0
# Ciclo for sui gruppi
for (group in seq(0, max(data$Gruppo) - 1)) {
# Filtra il dataset per il gruppo specifico
subset_gruppo <- data[data$Gruppo == group, ]
# Calcola la capacità_erogata
capacita_erogata_C7 <- cumsum(subset_gruppo$HMI_IBatt_C7) * subset_gruppo$Durata_scarica/3600
#cat(capacita_erogata_C7,"\n")
# Aggiorna la colonna Ah per la fase di scarica
data$Ah_C7[data$Gruppo == group & data$ID_C7 == -1] <- capacita_erogata_C7
}
load("my_workspace_projects_clean.RData")
save.image(file = "my_workspace_project_clean.RData")
View(data)
#! ---------------- Creazione tabella per gruppi Wattora
nuovo_dataframe <- data.frame(
Gruppo = integer(),    # Colonna per il Gruppo, inizializzata come intero
I_iniziale = numeric(), # Colonna per I_iniziale, inizializzata come numerico
I_media = numeric(),    # Colonna per I_media, inizializzata come numerico
I_finale = numeric()    # Colonna per I_finale, inizializzata come numerico
)
View(nuovo_dataframe)
#! ---------------- Creazione tabella per gruppi Wattora C2
df_C2 <- data.frame(
Gruppo = integer(),
I_iniziale = numeric(),
I_media = numeric(),
I_finale = numeric(),
V_iniziale = numeric(),
V_media = numeric(),
V_finale = numeric(),
Durata_scarica = numeric(),
Wattora = numeric(),
Stagione = character(),
POC_ID = integer()
)
data$Gruppo
unique(data$Gruppo)
#Riempiamo iterativamente il nuovo dataset
#Gruppo
df_C2$Gruppo <- unique(data$Gruppo)
df_C2 <- rbind(df_C2, 1519)
#! ---------------- Creazione tabella per gruppi Wattora C2
df_C2 <- data.frame(
Gruppo = integer(1519),
I_iniziale = numeric(1519),
I_media = numeric(1519),
I_finale = numeric(1519),
V_iniziale = numeric(1519),
V_media = numeric(1519),
V_finale = numeric(1519),
Durata_scarica = numeric(1519),
Wattora = numeric(1519),
Stagione = character(1519),
POC_ID = integer(1519)
)
View(df_C2)
#Riempiamo iterativamente il nuovo dataset
#Gruppo
df_C2$Gruppo <- unique(data$Gruppo)
View(df_C2)
View(df_C2)
for (group in seq(1, max(data$Gruppo) - 1)) {
subset_gruppo <- data[data$Gruppo == group, ]
#I iniziale finale e media
df_C2$I_finale[group] <- tail(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
#df_C2$I_iniziale[group]<- head(which(subset_gruppo$HMI_IBatt_C2 < 0), 1)
#df_C2$I_media[group]<-
}
View(df_C2)
View(data)
for (group in seq(1, max(data$Gruppo) - 1)) {
subset_gruppo <- data[data$Gruppo == group, ]
#I iniziale finale e media
df_C2$I_finale[group] <- tail(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$I_iniziale[group]<- head(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$I_media[group] <- mean(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0])
}
View(df_C2)
#V iniziale finale e media
df_C2$V_finale[group] <- tail(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$V_iniziale[group]<- head(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$V_media[group] <- mean(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0])
for (group in seq(1, max(data$Gruppo) - 1)) {
subset_gruppo <- data[data$Gruppo == group, ]
#I iniziale finale e media
df_C2$I_finale[group] <- tail(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$I_iniziale[group]<- head(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$I_media[group] <- mean(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0])
#V iniziale finale e media
df_C2$V_finale[group] <- tail(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$V_iniziale[group]<- head(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$V_media[group] <- mean(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0])
#
}
View(df_C2)
View(data)
for (group in seq(1, max(data$Gruppo) - 1)) {
subset_gruppo <- data[data$Gruppo == group, ]
#I iniziale finale e media
df_C2$I_finale[group] <- tail(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$I_iniziale[group]<- head(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$I_media[group] <- mean(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0])
#V iniziale finale e media
df_C2$V_finale[group] <- tail(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$V_iniziale[group]<- head(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$V_media[group] <- mean(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0])
# Durata scarica
df_C2$Durata_scarica[group] <- subset_gruppo$Durata_scarica[1]
}
View(df_C2)
for (group in seq(1, max(data$Gruppo) - 1)) {
subset_gruppo <- data[data$Gruppo == group, ]
#I iniziale finale e media
df_C2$I_finale[group] <- tail(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$I_iniziale[group]<- head(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$I_media[group] <- mean(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0])
#V iniziale finale e media
df_C2$V_finale[group] <- tail(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$V_iniziale[group]<- head(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$V_media[group] <- mean(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0])
# Durata scarica
df_C2$Durata_scarica[group] <- subset_gruppo$Durata_scarica[1]
# Stagione
df_C2$Stagione[group] <- subset_gruppo$stagione[1]
}
View(df_C2)
View(df_C2)
#! ---------------- Creazione tabella per gruppi Wattora C2
df_C2 <- data.frame(
Gruppo = integer(1519),
I_iniziale = numeric(1519),
I_media = numeric(1519),
I_finale = numeric(1519),
V_iniziale = numeric(1519),
V_media = numeric(1519),
V_finale = numeric(1519),
Durata_scarica = numeric(1519),
Wattora = numeric(1519),
Stagione = character(1519),
#POC_ID = integer(1519)
)
#Gruppo
df_C2$Gruppo <- unique(data$Gruppo)
for (group in seq(1, max(data$Gruppo) - 1)) {
subset_gruppo <- data[data$Gruppo == group, ]
#I iniziale finale e media
df_C2$I_finale[group] <- tail(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$I_iniziale[group]<- head(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$I_media[group] <- mean(subset_gruppo$HMI_IBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0])
#V iniziale finale e media
df_C2$V_finale[group] <- tail(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$V_iniziale[group]<- head(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0], 1)
df_C2$V_media[group] <- mean(subset_gruppo$HMI_VBatt_C2[subset_gruppo$HMI_IBatt_C2 < 0])
# Durata scarica
df_C2$Durata_scarica[group] <- subset_gruppo$Durata_scarica[1]
# Stagione
df_C2$Stagione[group] <- subset_gruppo$stagione[1]
# Wattora
df_C2$Wattora[group] <- subset_gruppo$Wattora_C2[1]
}
View(df_C2)
#! ---------------- Creazione tabella per gruppi Amperora C2
df_C2_Ah <- df_C2
#! ---------------- Creazione tabella per gruppi Amperora C2
df_C2_Ah <- df_C2
df_C2_Ah <- subset(df_C2_Ah, select = -Wattora)
df_C2_Ah$Amperora <- 0
View(data)
for (group in seq(1, max(data$Gruppo) - 1)) {
subset_gruppo <- data[data$Gruppo == group, ]
# Amperora
df_C2_Ah$Amperora[group] <- subset_gruppo$Ah_C2[1]
}
View(df_C2_Ah)
df_C2_Ah <- subset(df_C2_Ah, select = -POC_ID)
df_C2<- subset(df_C2, select = -POC_ID)
View(df_C2)
View(df_C2_Ah)
#load("my_workspace_projects_clean.RData")
save.image(file = "my_workspace_project_clean.RData")
generate_plot_V(17)
generate_plot_I <- function(group) {
group_data <- data[data$Gruppo == group, ]
ggplot(data = group_data, aes(x = second)) +
geom_line(aes(y = HMI_IBatt_C2, color = "C2"), linetype = "solid") +
geom_line(aes(y = HMI_IBatt_C4, color = "C4"), linetype = "solid") +
geom_line(aes(y = HMI_IBatt_C5, color = "C5"), linetype = "solid") +
geom_line(aes(y = HMI_IBatt_C7, color = "C7"), linetype = "solid") +
geom_hline(yintercept = 26.25, linetype = "dashed", color = "red") +
labs(title = paste("Gruppo", group), x = "Time (s)", y = "Ampere") +
scale_color_manual(values = c("blue", "green", "orange", "purple"), name = "Battery")
}
generate_plot_V <- function(group) {
group_data <- data[data$Gruppo == group, ]
ggplot(data = group_data, aes(x = second)) +
geom_line(aes(y = HMI_VBatt_C2, color = "C2"), linetype = "solid") +
geom_line(aes(y = HMI_VBatt_C4, color = "C4"), linetype = "solid") +
geom_line(aes(y = HMI_VBatt_C5, color = "C5"), linetype = "solid") +
geom_line(aes(y = HMI_VBatt_C7, color = "C7"), linetype = "solid") +
geom_hline(yintercept = 25.25, linetype = "dashed", color = "red") +
labs(title = paste("Group", group), x = "Time(s)", y = "Voltage") +
scale_color_manual(values = c("blue", "green", "orange", "purple"), name = "Battery")
}
generate_plot_V(17)
generate_plot_I <- function(group) {
group_data <- data[data$Gruppo == group, ]
ggplot(data = group_data, aes(x = second)) +
geom_line(aes(y = HMI_IBatt_C2, color = "C2"), linetype = "solid", size=1) +
geom_line(aes(y = HMI_IBatt_C4, color = "C4"), linetype = "solid", size=1) +
geom_line(aes(y = HMI_IBatt_C5, color = "C5"), linetype = "solid", size=1) +
geom_line(aes(y = HMI_IBatt_C7, color = "C7"), linetype = "solid", size=1) +
geom_hline(yintercept = 26.25, linetype = "dashed", color = "red") +
labs(title = paste("Gruppo", group), x = "Time (s)", y = "Ampere") +
scale_color_manual(values = c("blue", "green", "orange", "purple"), name = "Battery")
}
generate_plot_V <- function(group) {
group_data <- data[data$Gruppo == group, ]
ggplot(data = group_data, aes(x = second)) +
geom_line(aes(y = HMI_VBatt_C2, color = "C2"), linetype = "solid", size=1) +
geom_line(aes(y = HMI_VBatt_C4, color = "C4"), linetype = "solid", size=1) +
geom_line(aes(y = HMI_VBatt_C5, color = "C5"), linetype = "solid", size=1) +
geom_line(aes(y = HMI_VBatt_C7, color = "C7"), linetype = "solid", size=1) +
geom_hline(yintercept = 25.25, linetype = "dashed", color = "red") +
labs(title = paste("Group", group), x = "Time(s)", y = "Voltage") +
scale_color_manual(values = c("blue", "green", "orange", "purple"), name = "Battery")
}
generate_plot_V(17)
generate_plot_I <- function(group) {
group_data <- data[data$Gruppo == group, ]
ggplot(data = group_data, aes(x = second)) +
geom_line(aes(y = HMI_IBatt_C2, color = "C2"), linetype = "solid", linewidth=1) +
geom_line(aes(y = HMI_IBatt_C4, color = "C4"), linetype = "solid", linewidth=1) +
geom_line(aes(y = HMI_IBatt_C5, color = "C5"), linetype = "solid", linewidth=1) +
geom_line(aes(y = HMI_IBatt_C7, color = "C7"), linetype = "solid", linewidth=1) +
geom_hline(yintercept = 26.25, linetype = "dashed", color = "red") +
labs(title = paste("Gruppo", group), x = "Time (s)", y = "Ampere") +
scale_color_manual(values = c("blue", "green", "orange", "purple"), name = "Battery")
}
generate_plot_V <- function(group) {
group_data <- data[data$Gruppo == group, ]
ggplot(data = group_data, aes(x = second)) +
geom_line(aes(y = HMI_VBatt_C2, color = "C2"), linetype = "solid", linewidth=1) +
geom_line(aes(y = HMI_VBatt_C4, color = "C4"), linetype = "solid", linewidth=1) +
geom_line(aes(y = HMI_VBatt_C5, color = "C5"), linetype = "solid", linewidth=1) +
geom_line(aes(y = HMI_VBatt_C7, color = "C7"), linetype = "solid", linewidth=1) +
geom_hline(yintercept = 25.25, linetype = "dashed", color = "red") +
labs(title = paste("Group", group), x = "Time(s)", y = "Voltage") +
scale_color_manual(values = c("blue", "green", "orange", "purple"), name = "Battery")
}
generate_plot_V(17)
generate_plot_I(17)
View(df_C2)
View(df_C2_Ah)
View(df_C2_Ah)
View(df_C2)
generate_plot_I(1140)
g
generate_plot_I <- function(group) {
group_data <- data[data$Gruppo == group, ]
ggplot(data = group_data, aes(x = second)) +
geom_line(aes(y = HMI_IBatt_C2, color = "C2"), linetype = "solid", linewidth=1) +
geom_line(aes(y = HMI_IBatt_C4, color = "C4"), linetype = "solid", linewidth=1) +
geom_line(aes(y = HMI_IBatt_C5, color = "C5"), linetype = "solid", linewidth=1) +
geom_line(aes(y = HMI_IBatt_C7, color = "C7"), linetype = "solid", linewidth=1) +
geom_hline(yintercept = 26.25, linetype = "dashed", color = "red") +
labs(title = paste("Group", group), x = "Time (s)", y = "Ampere") +
scale_color_manual(values = c("blue", "green", "orange", "purple"), name = "Battery")
}
View(data)
generate_plot_I(17)
view(data[data$Gruppo==1140,])
#load("my_workspace_projects_clean.RData")
save.image(file = "my_workspace_project_clean.RData")
